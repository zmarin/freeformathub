---
import type { Tool } from '../../types';
import BaseLayout from '../../layouts/BaseLayout.astro';
import AdPlacement from '../ads/AdPlacement.astro';

export interface Props {
  tool: Tool;
  children?: any;
}

const { tool } = Astro.props;

// Generate structured data for the tool
const baseUrl = 'https://freeformathub.com';
const jsonLd = {
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": tool.name,
  "description": tool.description,
  "applicationCategory": "BusinessApplication",
  "operatingSystem": "Any",
  "permissions": "no-storage",
  "isAccessibleForFree": true,
  "creator": {
    "@type": "Organization",
    "name": "FreeFormatHub"
  },
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD",
    "availability": "https://schema.org/InStock",
    "validFrom": "2024-01-01",
    "seller": {
      "@type": "Organization",
      "name": "FreeFormatHub"
    }
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "4.9",
    "bestRating": "5",
    "worstRating": "1",
    "ratingCount": "127",
    "reviewCount": "3"
  }
};
---

<BaseLayout
  title={tool.seoTitle}
  description={tool.seoDescription}
  keywords={tool.keywords}
  jsonLd={jsonLd}
  showSidebar={false}
  fullWidth={true}
>
  <!-- Minimal Header -->
  <section style="background-color: var(--color-surface); border-bottom: 1px solid var(--color-border);">
    <div class="max-w-full mx-auto px-4 py-6">
      <!-- Tool Title Only -->
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-4">
          <div style="
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--color-primary), var(--color-accent));
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            border-radius: var(--radius-lg);
          ">
            {tool.icon}
          </div>
          <h1 style="
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--color-text-primary);
            margin: 0;
          ">
            {tool.name}
          </h1>
        </div>

        <!-- Optional compact breadcrumbs -->
        {tool.layoutOptions?.showBreadcrumbs !== false && (
          <nav aria-label="Breadcrumb" class="text-sm">
            <a href="/" style="color: var(--color-text-secondary);" class="hover:text-blue-600">Home</a>
            <span style="color: var(--color-text-muted); margin: 0 8px;">/</span>
            <a href={`/${tool.category?.id || ''}`} style="color: var(--color-text-secondary);" class="hover:text-blue-600">
              {tool.category?.name || 'Tools'}
            </a>
          </nav>
        )}
      </div>
    </div>
  </section>

  <!-- Fullscreen Tool Container -->
  <div style="height: calc(100vh - 120px); display: flex; flex-direction: column;">
    <!-- Tool Interface takes full height -->
    <div style="flex: 1; margin: var(--space-lg); border-radius: var(--radius-xl); overflow: hidden; background: var(--color-surface);">
      <slot />
    </div>

    <!-- Compact Footer Ad -->
    <div style="padding: var(--space-md); background: var(--color-surface-secondary);">
      <div style="max-width: 728px; margin: 0 auto;">
        <AdPlacement type="footer" lazy={true} />
      </div>
    </div>
  </div>
</BaseLayout>
